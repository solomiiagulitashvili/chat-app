(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{104:function(e,t){},107:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(9),c=n.n(r),l=(n(63),n(64),"USERNAME_INPUT_CHANGE"),s="USERNAME_CHANGE",u="TOOGLE_MODAL",m="ROOM_NAME_CHANGE",i="SET_ROOMS",p="SELECT_ROOM",f="DELETE_ROOM",h=function(){return function(e,t){t();fetch("/api/room/",{headers:{"Content-type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e(d(t))}))}},d=function(e){return{type:i,payload:e}},g=function(){return{type:f}},O=n(15),y=n(11),E=n(12),b=n(16),v=n(13),N=n(17),j=n(108),C=n(109),k=n(115),R=n(110),S=n(114),D=n(111),I=n(112),M=n(113),w=function(e){function t(){var e,n;Object(y.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(b.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(o)))).setRoomName=function(){n.props.onRoomNameChange(),n.props.onToggleModal()},n.onInputNameChange=function(e){n.props.onUserNameInputChange(e.target.value)},n.onClickNameChange=function(){n.props.onUserNameChange()},n.onClickRoomNameChange=function(){n.props.onToggleModal(),n.props.onCreateRoom()},n.onInputRoomNameChange=function(e){n.props.onRoomNameChange(e.target.value)},n}return Object(N.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onToggleModal,n=e.userNameInputValue,a=e.userName,r=e.modal,c=e.roomNameInputValue;return o.a.createElement("header",null,o.a.createElement("h3",{className:"col-2"},"Chatt-App"),o.a.createElement("div",{className:"wrapper col-8 offset-2"},o.a.createElement("span",{className:"username"},a," "),o.a.createElement("div",{className:"btns-wrapper"},o.a.createElement(j.a,null,o.a.createElement(C.a,{placeholder:"Set your name...",value:n,onChange:this.onInputNameChange}),o.a.createElement(k.a,{addonType:"append"},o.a.createElement(R.a,{color:"primary",onClick:this.onClickNameChange},"Set")))),o.a.createElement("div",{className:"btn-create"},o.a.createElement(R.a,{color:"primary",onClick:t},"Create room")),o.a.createElement(S.a,{isOpen:r,toggle:t},o.a.createElement(D.a,null,o.a.createElement(I.a,{for:"roomName"},"Room name"),o.a.createElement(C.a,{type:"text",id:"roomName",placeholder:"Enter room name",value:c,onChange:this.onInputRoomNameChange})),o.a.createElement(M.a,null,o.a.createElement(R.a,{color:"primary",onClick:this.onClickRoomNameChange},"Create room")," ",o.a.createElement(R.a,{color:"secondary",onClick:t},"Cancel")))))}}]),t}(o.a.Component),P=Object(O.b)((function(e){var t=e.general;return{userNameInputValue:t.userNameInputValue,userName:t.userName,modal:t.modal,roomNameInputValue:t.roomNameInputValue}}),(function(e){return{onUserNameInputChange:function(t){return e(function(e){return{type:l,payload:e}}(t))},onUserNameChange:function(){return e({type:s})},onToggleModal:function(){return e({type:u})},onRoomNameChange:function(t){return e(function(e){return{type:m,payload:e}}(t))},onCreateRoom:function(){return e((function(e,t){var n=t();fetch("/api/room/",{method:"POST",body:JSON.stringify({name:n.general.roomNameInputValue}),headers:{"Content-type":"application/json"}}).then((function(){e(h())}))}))}}}))(w),_=function(e){function t(){return Object(y.a)(this,t),Object(b.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(N.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.props.getRooms()}},{key:"render",value:function(){var e=this.props,t=e.roomsList,n=e.selectRoom;return o.a.createElement("div",null,o.a.createElement("ul",{className:"room-list"},t.map((function(e){return o.a.createElement("li",{key:e._id,onClick:function(){n(e._id)}},e.name)}))))}}]),t}(o.a.Component),T=Object(O.b)((function(e){return{roomsList:e.rooms.rooms}}),(function(e){return{getRooms:function(t){return e(h(t))},selectRoom:function(t){return e({type:p,payload:t})}}}))(_),V=n(56),A=n(52),L=n(53),U=n.n(L),H=function(e){function t(e){var n;Object(y.a)(this,t),(n=Object(b.a)(this,Object(v.a)(t).call(this,e))).onClick=function(){n.props.deleteRoom()},n.onClickSend=function(){n.socket.emit("message",{author:n.props.userName,text:n.state.message,room:n.props.room._id},(function(e){n.setState({response:[].concat(Object(V.a)(n.state.response),[e])})})),n.setState({message:""})},n.componentDidUpdate=function(e,t){var a=document.querySelector(".messages-list");t.response.length<n.state.response.length&&(a.scrollTop=a.scrollHeight-a.clientHeight)},n.onInputChange=function(e){n.setState({message:e.target.value})};return n.socket=U()({path:"/api/socket/"},{transports:["websocket"]}),n.state={response:[],message:""},n}return Object(N.a)(t,e),Object(E.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;if(!this.props.room&&e.room||e.room&&e.room._id!==this.props.room._id){var n=e.room._id;this.socket.emit("room",n,(function(e){t.setState({response:e})}))}}},{key:"componentDidMount",value:function(){var e=this;this.socket.on("messages",(function(t){console.log(t),e.setState({response:t})}))}},{key:"render",value:function(){var e=Object(A.a)("{HH}:{mm}:{ss}, {MMMM} {DD}",{MMMM:function(e){return e.toLocaleString("default",{month:"long"})},DD:function(e){return e.getDate()}});return this.props.room?o.a.createElement("div",null,o.a.createElement("div",{className:"room"},o.a.createElement("div",{className:"room-header"},o.a.createElement("h4",null,this.props.room.name," "),o.a.createElement(R.a,{color:"primary",onClick:this.onClick},"Delete room")),o.a.createElement("div",null,o.a.createElement("ul",{className:"chat"},o.a.createElement("div",{className:"messages-list"},this.state.response&&this.state.response.map((function(t){return o.a.createElement("li",{key:t._id},o.a.createElement("h6",null,t.author," "),o.a.createElement("p",null,t.text," "),o.a.createElement("span",null,e(new Date(t.datetime))))}))),o.a.createElement(j.a,null,o.a.createElement(C.a,{placeholder:"Your message here...",value:this.state.message,onChange:this.onInputChange}),o.a.createElement(k.a,{addonType:"append"},o.a.createElement(R.a,{color:"primary",onClick:this.onClickSend},"Send"))))))):o.a.createElement("div",null,o.a.createElement("p",null,"Select or create room"))}}]),t}(o.a.Component),x=Object(O.b)((function(e){var t=e.rooms,n=e.general;return{room:t.rooms.find((function(e){return e._id===t.selectedRoom})),userName:n.userName}}),(function(e){return{deleteRoom:function(){return e((function(e,t){var n=t();fetch("/api/room/",{method:"DELETE",body:JSON.stringify({_id:n.rooms.selectedRoom}),headers:{"Content-type":"application/json"}}).then((function(t){t.ok&&e(g())})).then((function(){e(h())}))}))},onDeleteRoom:function(){return e(g())}}}))(H),G=function(e){function t(){return Object(y.a)(this,t),Object(b.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(N.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"main"},o.a.createElement("div",{className:"col-3"},o.a.createElement(T,null)),o.a.createElement("div",{className:"col-8  offset-1"},o.a.createElement(x,null)))}}]),t}(o.a.Component);var J=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(P,null),o.a.createElement(G,null))},W=n(10),q=n(19);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(n,!0).forEach((function(t){Object(q.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z={userNameInputValue:"",userName:"anonymous",modal:!1,roomNameInputValue:""};var F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:return Y({},e,{userNameInputValue:t.payload});case s:return Y({},e,{userNameInputValue:"",userName:e.userNameInputValue});case u:return Y({},e,{modal:!e.modal});case m:return Y({},e,{roomNameInputValue:t.payload})}return e};function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach((function(t){Object(q.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X={rooms:[],selectedRoom:null};var Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i:return Q({},e,{rooms:t.payload});case p:return Q({},e,{selectedRoom:t.payload});case f:return Q({},e,{selectedRoom:null})}return e},$=Object(W.combineReducers)({general:F,rooms:Z}),ee=n(54),te=n(55),ne=Object(W.createStore)($,{},Object(te.composeWithDevTools)(Object(W.applyMiddleware)(ee.a)));c.a.render(o.a.createElement(O.a,{store:ne},o.a.createElement(J,null)),document.getElementById("root"))},58:function(e,t,n){e.exports=n(107)},64:function(e,t,n){}},[[58,1,2]]]);
//# sourceMappingURL=main.b8b40074.chunk.js.map